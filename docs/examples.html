
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Examples &#8212; Satyrus 3.0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python API" href="api.html" />
    <link rel="prev" title="SATish Language" href="satish.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<section id="problem-modelling">
<h2>Problem Modelling<a class="headerlink" href="#problem-modelling" title="Permalink to this headline">¶</a></h2>
<section id="graph-coloring">
<h3>Graph Coloring<a class="headerlink" href="#graph-coloring" title="Permalink to this headline">¶</a></h3>
<p>For a first modelling example we will take a look at some graph coloring in a simple setup with 5 nodes.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/graph.svg"><img alt="A graph with 5 nodes" src="_images/graph.svg" width="100%" /></a>
</figure>
<p>To represent this graph in SATish we write an array declaration foolowed by its structure initialization.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline"># Number of verties in the graph.</span><span class="w"></span>
<span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">;</span><span class="w"></span>

<span class="c c-Singleline"># Graph representation</span><span class="w"></span>
<span class="n">neigh</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>In this case, all array entries are constants. Next, we declare our problem unknowns, the color assignment for each vertex and also the list of used colors.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline"># Correspondence between each vertex and its color</span><span class="w"></span>
<span class="n">vc</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">];</span><span class="w"></span>

<span class="c c-Singleline"># Used colors, a quantity we wish to minimize.</span><span class="w"></span>
<span class="n">c</span><span class="p">[</span><span class="n">n</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p>Now, we state the constraints that well define the graph coloring problem. First of all, it is fundamental that neighbours <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> do not share a same color <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="k">(int)</span><span class="w"> </span><span class="n">neighbour_coloring</span><span class="p">[</span><span class="m">2</span><span class="p">]:</span><span class="w"></span>
<span class="w">    </span><span class="k">forall</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">    </span><span class="k">forall</span><span class="p">{</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">],</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">forall</span><span class="p">{</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">    </span><span class="n">neigh</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="n">vc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
<p>It is also important to keep track of the colors being used, that is, for each vertex <span class="math notranslate nohighlight">\(i\)</span> dyed with a color <span class="math notranslate nohighlight">\(k\)</span> we say that <span class="math notranslate nohighlight">\(k\)</span> is used.</p>
<p>That yields the logical expression <span class="math notranslate nohighlight">\(\forall i \,\, \forall k \,\, vc_{i, k} \implies c_{k}\)</span>.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="k">(int)</span><span class="w"> </span><span class="n">use_color</span><span class="p">[</span><span class="m">1</span><span class="p">]:</span><span class="w"></span>
<span class="w">    </span><span class="k">forall</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">    </span><span class="k">forall</span><span class="p">{</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">    </span><span class="n">vc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p>Following, we say that to every vertex must be assigned a unique color, where we may use the <code class="docutils literal notranslate"><span class="pre">unique</span></code> quantifier keyword i.e. there exists exactly one color <span class="math notranslate nohighlight">\(k\)</span> related to vertex <span class="math notranslate nohighlight">\(i\)</span>.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="k">(int)</span><span class="w"> </span><span class="n">color_all</span><span class="p">[</span><span class="m">1</span><span class="p">]:</span><span class="w"></span>
<span class="w">    </span><span class="k">forall</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">    </span><span class="k">unique</span><span class="p">{</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">    </span><span class="n">vc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p>Last but not least, we define our optimality constraint, where we state that every color used increases the overall cost.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="k">(opt)</span><span class="w"> </span><span class="n">cost</span><span class="p">:</span><span class="w"> </span><span class="k">exists</span><span class="p">{</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"> </span><span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Note:</strong> The whole <code class="docutils literal notranslate"><span class="pre">graph_color.sat</span></code> file is available for downaload <a class="reference download internal" download="" href="_downloads/747ce6c3bafa862ee0a14126d9e7a6fa/graph_color.sat"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</section>
<section id="travelling-salesman-problem">
<h3>Travelling Salesman Problem<a class="headerlink" href="#travelling-salesman-problem" title="Permalink to this headline">¶</a></h3>
<p>One more graph-oriented example will be a Travelling Salesman Problem (TSP) instance with 4 cities.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/tsp.svg"><img alt="A graph with 5 nodes" src="_images/tsp.svg" width="100%" /></a>
</figure>
<p>We start by representing our graph structure. As the starting position doesn’t matter f
or the problem formulation, we duplicate the <em>first town</em>, thus creating a <em>ghost town</em>, intended to be the last on the tour. The <em>ghost town</em> has the same connections as its twin and the distance between this two is zero, as is the distance between any node to itself.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">;</span><span class="w"></span>

<span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">):</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">):</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">):</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">2</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">4</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">):</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"></span>

<span class="w">   </span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">2</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">3</span><span class="p">):</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">):</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">):</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="n">tour</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">];</span><span class="w"> </span><span class="c c-Singleline"># (town, tour position) pairs</span><span class="w"></span>
</pre></div>
</div>
<p>We defined also a <code class="docutils literal notranslate"><span class="pre">tour</span></code> structure, which assigns every town a position on the tour. Also, it is important to clamp the mirrored towns to the tour’s endpoints.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline"># Low Penalty Level</span><span class="w"></span>
<span class="n">LOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"></span>

<span class="c c-Singleline"># Fix both endpoints (the first town and its ghost town)</span><span class="w"></span>
<span class="k">(int)</span><span class="w"> </span><span class="n">mirror_town</span><span class="p">[</span><span class="n">LOW</span><span class="p">]:</span><span class="w"> </span><span class="n">tour</span><span class="p">[</span><span class="m">1</span><span class="p">][</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">tour</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p>Another option would be to define these boudaries directyle into the <code class="docutils literal notranslate"><span class="pre">tour</span></code> declaration.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="n">tour</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">):</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>All other entries are left as variables.</p>
<p>The sole integrity constraint to be guaranteed is that every town occupies a single position on the tour. Conversely, every turn must be assigned to a single town.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="k">(int)</span><span class="w"> </span><span class="n">visit_all_once</span><span class="p">[</span><span class="n">LOW</span><span class="p">]:</span><span class="w"></span>
<span class="w">   </span><span class="c c-Singleline"># Every city &#39;i&#39; appears uniquely across the tour.</span><span class="w"></span>
<span class="w">   </span><span class="k">forall</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">   </span><span class="k">unique</span><span class="p">{</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">   </span><span class="n">tour</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="w"></span>

<span class="k">(int)</span><span class="w"> </span><span class="n">fill_all_once</span><span class="p">[</span><span class="n">LOW</span><span class="p">]:</span><span class="w"></span>
<span class="w">   </span><span class="c c-Singleline"># Every tour position &#39;i&#39; has exactly one city &#39;j&#39; associated to it.</span><span class="w"></span>
<span class="w">   </span><span class="k">unique</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">   </span><span class="k">forall</span><span class="p">{</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"></span>
<span class="w">   </span><span class="n">tour</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p>The optimality constraints are built upon accounting for the costs that lie between nodes who are neighbours on the tour. This must be done twice in order to handle assymetrical setups.</p>
<div class="highlight-satish notranslate"><div class="highlight"><pre><span></span><span class="k">(opt)</span><span class="w"> </span><span class="n">backwards_cost</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="k">exists</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"> </span><span class="c c-Singleline"># for each city &#39;i&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">exists</span><span class="p">{</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">j</span><span class="p">}</span><span class="w"> </span><span class="c c-Singleline"># for each other city &#39;j&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">exists</span><span class="p">{</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">2</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"> </span><span class="c c-Singleline"># for each position</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">tour</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">tour</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="o">-</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="w"></span>

<span class="k">(opt)</span><span class="w"> </span><span class="n">forwards_cost</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="k">exists</span><span class="p">{</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">]}</span><span class="w"> </span><span class="c c-Singleline"># for each city &#39;i&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">exists</span><span class="p">{</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">j</span><span class="p">}</span><span class="w"> </span><span class="c c-Singleline"># for each other city &#39;j&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">exists</span><span class="p">{</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="m">1</span><span class="p">]}</span><span class="w"> </span><span class="c c-Singleline"># for each position</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">tour</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">tour</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="o">+</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Note:</strong> The whole <code class="docutils literal notranslate"><span class="pre">tsp.sat</span></code> file is available for downaload <a class="reference download internal" download="" href="_downloads/7e111784727f22c3182b8701d3742df2/tsp.sat"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</section>
<section id="knapsack">
<h3>Knapsack<a class="headerlink" href="#knapsack" title="Permalink to this headline">¶</a></h3>
<p>This is the Knapsack Problem.</p>
</section>
</section>
<section id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h2>
<p>As the source file is complete, one could simply run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ satyrus graph_color.sat
</pre></div>
</div>
<p>This will output the <code class="docutils literal notranslate"><span class="pre">graph_color.json</span></code> file, with an array object containing in each entry a “term” array of unknowns and its respective multiplicative constant “cons”. If there is any constant term, its value for the “term” key will be <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<p>This is intended to represent the problem’s energy equation.</p>
<p><strong>Note:</strong> It is possible to set the output destination using the <code class="docutils literal notranslate"><span class="pre">-o,</span> <span class="pre">--ouput</span></code> option, followed by the desired target.</p>
</section>
<section id="solver-interface">
<h2>Solver Interface<a class="headerlink" href="#solver-interface" title="Permalink to this headline">¶</a></h2>
<p>In order to pass the generated energy equation to a solver, it is enough to use the <code class="docutils literal notranslate"><span class="pre">-s,</span> <span class="pre">--solver</span></code> option.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ satyrus graph_color.sat -s gurobi
</pre></div>
</div>
<p>The expected behaviour is to store the solution in the <code class="docutils literal notranslate"><span class="pre">graph_color.json</span></code> file, under keys “solution” and “energy”, being the first a mapping between variables and its values and the latter the total energy for the given setup.</p>
<p><strong>Note:</strong> Run <code class="docutils literal notranslate"><span class="pre">satyrus</span> <span class="pre">--help</span></code> for a list of the available solvers in your installation.</p>
<p>Parameters may be passed to the solver using a separate JSON file containing the corresponding mapping. The destination for feeding the parameters file must be provided using the <code class="docutils literal notranslate"><span class="pre">-p,</span> <span class="pre">--params</span></code> command-line option.</p>
<p>When running the <code class="docutils literal notranslate"><span class="pre">dwave</span></code> solver, it is possible to specify both <code class="docutils literal notranslate"><span class="pre">num_reads</span></code> and <code class="docutils literal notranslate"><span class="pre">num_sweeps</span></code> by providing the <code class="docutils literal notranslate"><span class="pre">dwave.json</span></code> file as follows:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nt">&quot;num_reads&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
   <span class="nt">&quot;num_sweeps&quot;</span><span class="p">:</span> <span class="mi">10000</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and then, by typing the right command and hitting enter.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ satyrus graph_color.sat -s dwave -p dwave.json
</pre></div>
</div>
</section>
<section id="custom-api-setup">
<h2>Custom API Setup<a class="headerlink" href="#custom-api-setup" title="Permalink to this headline">¶</a></h2>
<p>Defining custom solver interfaces is pretty straightforward. In a separate Python file, import the <code class="docutils literal notranslate"><span class="pre">SatAPI</span></code> type from the <code class="docutils literal notranslate"><span class="pre">satyrus</span></code> package and subclass it as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Future Imports</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="c1"># Satyrus Imports</span>
<span class="kn">from</span> <span class="nn">satyrus</span> <span class="kn">import</span> <span class="n">SatAPI</span><span class="p">,</span> <span class="n">Posiform</span>

<span class="k">class</span> <span class="nc">MyPartialAPI</span><span class="p">(</span><span class="n">SatAPI</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posiform</span><span class="p">:</span> <span class="n">Posiform</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;My Solution&quot;</span>

<span class="k">class</span> <span class="nc">MyCompleteAPI</span><span class="p">(</span><span class="n">SatAPI</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posiform</span><span class="p">:</span> <span class="n">Posiform</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="c1"># Completely ignores problem defined by &#39;posiform&#39;</span>
        <span class="c1"># giving always the same solution:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">e</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>Your new class must implement the <code class="docutils literal notranslate"><span class="pre">solve</span></code> method, which must have one of the two signatures presented above. It receives a <code class="docutils literal notranslate"><span class="pre">Posiform</span></code> object and some eventual keyword arguments. If the return type is a tuple containing a solution mapping and its respective energy, the solution is considered to be <em>complete</em>, receiving special formatting when delivered to the output file. Otherwise, a string representation of the output object is dumped to the target destination as-is.</p>
<p>After writing the contents above to the <code class="docutils literal notranslate"><span class="pre">myapi.py</span></code> file, it becomes possible to include the custom interface by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ satyrus graph_color.sat --api myapi.py -s MyCompleteAPI
</pre></div>
</div>
<p><strong>Note:</strong> As you might be thinking, it is important to chose the class name wisely!</p>
<p>More about the Python API is found on this <a class="reference external" href="./api.html">page</a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Satyrus</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="satish.html">SATish Language</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problem-modelling">Problem Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compilation">Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solver-interface">Solver Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-api-setup">Custom API Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="satish.html" title="previous chapter">SATish Language</a></li>
      <li>Next: <a href="api.html" title="next chapter">Python API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Pedro Maciel Xavier.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/examples.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>